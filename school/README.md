# AI 文字角色扮演游戏 (School RPG)

这是一个基于 Vue 3 + Vite + Pinia 构建的沉浸式 AI 文字角色扮演游戏。玩家可以创建自定义角色，在校园环境中探索、互动，并通过与 AI 的对话推动剧情发展。

## 🌟 核心特性

### 🎭 深度角色定制
*   **入学流程**：完整的角色创建向导，包含姓名、性别、班级选择。
*   **人生设定**：选择人生目标（游戏模式）和家庭背景，支持自定义背景故事。
*   **成长经历**：从幼年到初中的成长抉择，塑造角色初始属性。
*   **天赋系统**：多样化的天赋选择，提供独特的游戏加成。
*   **属性加点**：自由分配属性点、学科知识和生活技能。

### 🎮 沉浸式游戏体验
*   **动态界面**：左侧实时显示角色状态（时间、属性、背包），右侧提供系统菜单。
*   **地图系统**：可视化的校园地图，支持拖拽、缩放和层级导航。
*   **手机系统**：内置虚拟智能手机，提供背包、地图、存档等快捷入口。
*   **社交网络**：**全新的社交应用**。支持与 NPC 进行私聊、群聊，查看朋友圈。消息记录持久化存储于世界书中，支持未读红点提示和实时消息推送。
*   **夜间模式**：全界面适配深色主题，保护视力，营造氛围。

### 💾 高级存档系统
*   **持久化存储**：存档自动保存在浏览器本地，刷新不丢失。
*   **导入/导出**：支持将存档导出为 JSON 文件备份，或从文件导入进度。
*   **时光倒流**：**独创的回溯功能**。读取存档时，可以预览最近 20 条对话记录，点击任意一条即可回溯到该时刻，且**游戏状态（属性、物品、时间等）会精确恢复到那一刻**。

### 🤖 智能对话交互
*   **AI 驱动**：通过 SillyTavern API (或模拟环境) 生成剧情，支持流式传输。
*   **智能控制**：
    *   **停止生成**：随时中断 AI 的输出。
    *   **自动重试**：发送失败或停止后，可直接点击发送按钮重试。
    *   **合并发送**：在重试时输入新内容，系统会自动将旧消息与新内容合并发送，方便补充遗漏信息。
    *   **指令队列**：支持将社交消息等操作加入待发送队列，由 AI 统一处理。

## 🛠️ 技术栈

*   **前端框架**: Vue 3
*   **构建工具**: Vite
*   **状态管理**: Pinia
*   **样式**: CSS Variables (支持动态主题切换)
*   **字体**: Ma Shan Zheng (马善政毛笔字体)

## 🚀 快速开始

### 环境要求
*   Node.js 16+

### 安装依赖

```sh
npm install
```

### 启动开发服务器

```sh
npm run dev
```

### 构建生产版本

```sh
npm run build
```

## 📂 项目结构

*   `src/components`: UI 组件 (GameMain, SavePanel, SocialApp, etc.)
*   `src/stores`: Pinia 状态管理 (gameStore)
*   `src/utils`: 工具函数 (stClient, socialWorldbook, messageParser)
*   `src/data`: 静态数据 (地图、班级信息)
*   `function`: 类型定义文件

## 📝 许可证

MIT
